# SPEC-035: 洞察模块触发机制与文档体系

> 作者: Boris Huai
> 起草日期: 2026-01-28
> 状态: 已完成

## 问题陈述 (Why)

1. **触发机制缺失**：配置变更后，用户需手动执行 /insight，易遗忘
2. **文档缺失**：洞察模块功能复杂，缺少统一说明文档

## 目标与成功标准 (DoD)

| # | 验收标准 | 状态 |
|---|----------|------|
| 1 | 洞察模块 README 文档完整 | ✅ |
| 2 | /insight 命令文档更新 | ✅ |
| 3 | 配置变更触发机制实现 | ✅ |
| 4 | Session 日志记录 | ✅ |

## 非目标 (Out of Scope)

- 实时文件监听（需后端支持）
- 自动化调度系统
- 后端 API 开发

## 技术方案 (How)

### 1. 触发机制决策

**选择方案**：配置面板内置触发提示

| 方案 | 评估 |
|------|------|
| A. 文件监听 Hook | 需要后端改造，放弃 |
| B. 配置面板内置触发 | ✅ 采用，简单有效 |
| C. Claude Code Hook | 仅会话内生效，局限性大 |
| D. 配置版本检测 | 被动检测，作为补充 |

**实现方式**：
- 导出配置后显示成功提示框
- 提示包含操作步骤和可复制的 `/insight` 命令
- 10秒后自动隐藏提示

### 2. 文档结构

采用单文件方案：`docs/insight/README.md`

**内容结构**：
1. 功能概述
2. 四大维度介绍
3. 数据源配置详解
4. /insight 工作流程
5. 配置变更流程
6. 文件结构
7. 扩展指南

### 3. 命令文档更新

更新 `.claude/commands/insight.md`：
- 添加数据源说明
- 详细执行流程
- 配置变更后的操作指引
- 相关文档链接

## 交互设计 (UX)

### 导出成功提示

```
┌─────────────────────────────────────────────────┐
│ ✅ topics.json 已下载                            │
├─────────────────────────────────────────────────┤
│ 请按以下步骤完成配置更新：                        │
│                                                 │
│ 1. 将下载的文件移动到                            │
│    frontend/public/data/insights/               │
│ 2. 执行 /insight 使用新配置刷新数据              │
│ 3. 刷新页面查看结果                              │
│                                                 │
│ ┌─────────────────────────────────────────────┐ │
│ │ 📋 复制 /insight 命令                        │ │
│ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────┘
```

## 决策记录 (Decision Log)

| 日期 | 决策 | 理由 | 替代方案 |
|------|------|------|----------|
| 2026-01-28 | 配置面板内置触发提示 | 零后端改动、用户体验清晰 | 文件监听、Hook |
| 2026-01-28 | 单文件 README | 内容适中、易维护、一目了然 | 多文件拆分 |

## 产出文件

1. `docs/insight/README.md` - 洞察模块完整文档
2. `.claude/commands/insight.md` - 更新后的命令文档
3. `frontend/src/components/Insight/InsightConfigPanel.tsx` - 添加导出成功提示
4. `frontend/src/components/Insight/InsightView.css` - 导出成功提示样式
